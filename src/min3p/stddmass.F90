!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 786 $
!> $Author: dsu $
!> $Date: 2021-01-06 21:41:32 -0800 (Wed, 06 Jan 2021) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/stddmass.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c real*8 function stddmass
!c ------------------------
!c
!c compute mass storage term for density dependent flow in
!c variably saturated conditions with fluid pressure as the
!c primary dependent variable
!c
!c storage function used only for mass balance calculations in 
!c msysdd.f subroutine
!c
!c assign fluid densities as a function of total component 
!c concentrations and empirical linear coefficient drho_dc
!c
!c written by:      Tom Henderson - August 19, 2002
!c
!c last modified:   Tom Henderson - March 25, 2003
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           ------- 
!c           deltnew            = current time step                   + -
!c           delttds            = previous time step                  + -
!c           dens_ivol          = water density                       + - 
!c           pressnew           = fluid pressure (new time level)     + -
!c           pressold           = fluid pressure (old time level)     + -
!c           satwnew            = water saturation (new time level)   + -
!c           satwold            = water saturation (old time level)   + -
!c           tdsnew             = TDS (new time level)                + -  
!c           tdsold             = TDS (old time level)                + -
!c
!c           integer*4:
!c           ----------
!c           izn                = pointer (material property zone)    + -
!c
!c common: 
!c phys.f:   nzn                = number of zones                     + -
!c           por                = porosity                            + -
!c           spstor(nzn)        = specific storage coefficient        + -
!c                                wrt fluid pressure
!c
!c dens.f:   drho_dc            = density-TDS constant drho/dTDS      + -
!c           
!c
!c local:    real*8:
!c           -------
!c           densstor           = mass storage from temporal 
!c                                density variations
!c           elast              = elastic mass storage from pressure
!c                                variations
!c
!c external: -
!c ----------------------------------------------------------------------
 
      real*8 function stddmass(pressnew,satwnew, storage,izn,dens_ivol)
 
      use parm
      use phys
      use dens
      use gen
 
      implicit none
      
      real*8 :: pressnew,satwnew, storage,dens_ivol
      
      integer :: izn

!c  spstor(izn) converted to units of pressure in subroutine  
!c  initppdd using the following equation:  
!c  spstor(izn) = spstor(izn)/(gacc * ref_dens)


      stddmass =  storage * satwnew * dens_ivol * pressnew            &
     &       + pornew(izn) * dens_ivol * satwnew
     
      
      return
      end
