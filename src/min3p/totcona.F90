!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 786 $
!> $Author: dsu $
!> $Date: 2021-01-06 21:41:32 -0800 (Wed, 06 Jan 2021) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/totcona.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine totcona
!c -------------------
!c
!c compute total adsorbed component concentration due to 
!c non-competitive sorption reactions 
!c
!c written by:      Uli Mayer - June 22, 2002
!c
!c last modified:   - 
!c                  Danyang Su - May, 2020
!c                               Add decay in adsorbed component.
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           tota(nc)           = total sorbed component              * +
!c                                concentrations
!c                                non-competitive sorption
!c                                [moles/l bulk)
!c           totc(n)            = total component concentrations      + -
!c                                [moles/l water]  
!c           distcoff(nc)       = sorption distribution coefficient   + -
!c                                [l h2o/l bulk] 
!c           sw                 = water saturation                    + -
!c           por                = porosity                            + -
!c
!c           integer*4:
!c           ----------
!c           ilog               = unit number - logbook               + -
!c
!c common:   
!c chem.f:   real*8:
!c           -------
!c           distcoff_lc(nc)    = 
!c
!c           integer*4:
!c           ----------
!c           nc                 = number of components including h2o  + -
!c           
!c
!c           character:
!c           ----------
!c           isotherm_type(nc)  = definition of sorption isotherm     + -   
!c                                'none' = no sorption
!c                                'linear' = linear adsorption
!c                                'freundlich' = Freundlich isotherm
!c                                'langmuir' = Langmuir isotherm
!c
!c local:    real*8:
!c           -------
!c           r0                 = constant
!c
!c           integer*4:
!c           ----------
!c           ic                 = counter (components)
!c     
!c           character:
!c           ----------
!c           zone_name          = name of zone
!c
!c
!c external: 
!c ----------------------------------------------------------------------
 
      subroutine totcona(tota,totc,distcoff,sw,por)
 
      use parm
      use chem
 
      implicit none
      
      real*8 :: tota, totc, distcoff, sw, por

      dimension totc(*),tota(*),distcoff(*)

      real*8, parameter :: r0 = 0.0d0
      
      integer :: ic

!c  compute sorbed concentrations

      do ic = 1,nc-1

!c  linear isotherm

      if (isotherm_type(ic).eq.'linear') then

        tota(ic) = distcoff(ic)*sw*por*totc(ic)

!c  no isotherm specified
      
      elseif (isotherm_type(ic).eq.'none') then
          
        tota(ic) = r0
        
      end if

      end do         !(loop over components)

      return
      end
