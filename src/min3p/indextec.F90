!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 609 $
!> $Author: dsu $
!> $Date: 2018-09-14 11:47:55 -0700 (Fri, 14 Sep 2018) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/indextec.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine indextec
!c -------------------
!c assign i,j,k indices for tecplot postprocessing
!c
!c written by:      Uli Mayer - June 24, 96
!c
!c last modified:   -
!c
!c                  Danyang Su - March 14, 2014
!c                  HPC capabilities
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c   
!c                                                                    I O
!c passed:   -
!c
!c common:
!c gen.f:    nvx                = number of control volumes in        + -
!c                                x-direction
!c           nvy                = number of control volumes in        + -
!c                                y-direction
!c           nvz                = number of control volumes in        + -
!c                                z-direction
!c           itec               = i-index for tecplot                 * +
!c           jtec               = j-index for trcplot                 * +
!c           ktec               = k-index for tecplot                 * +
!c
!c local:    -  
!c
!c external: -
!c ----------------------------------------------------------------------

      subroutine indextec
 
      use parm
      use gen

      implicit none

!c  assign counters i,j,k for tecplot output
!c  for 3d - case

      !for subdomain 
      if ((nvx.gt.1).and.(nvy.gt.1).and.(nvz.gt.1)) then
        itec = nvx
        jtec = nvy
        ktec = nvz
        
        itec_vel = itec
        jtec_vel = jtec
        ktec_vel = ktec
        
        if(nvxgls == nvxls) then
            itec_vel = itec_vel - 1
        end if
        
        if(nvygls == nvyls) then
            jtec_vel = jtec_vel - 1
        end if
        
        if(nvzgls == nvzls) then
            ktec_vel = ktec_vel - 1
        end if
      end if

!c  for 2d-cases

      if ((nvx.gt.1).and.(nvy.gt.1).and.(nvz.eq.1)) then        !xy-plane
        itec = nvx
        jtec = nvy
        ktec = 1
        
        itec_vel = itec
        jtec_vel = jtec
        ktec_vel = ktec
        
        if(nvxgls == nvxls) then
            itec_vel = itec_vel - 1
        end if
        
        if(nvygls == nvyls) then
            jtec_vel = jtec_vel - 1
        end if
        
      elseif ((nvx.gt.1).and.(nvy.eq.1).and.(nvz.gt.1)) then    !xz-plane
        itec = nvx
        jtec = nvz
        ktec = 1
        
        itec_vel = itec
        jtec_vel = jtec
        ktec_vel = ktec
        
        if(nvxgls == nvxls) then
            itec_vel = itec_vel - 1
        end if        
        
        if(nvzgls == nvzls) then
            jtec_vel = jtec_vel - 1
        end if
        
      elseif ((nvx.eq.1).and.(nvy.gt.1).and.(nvz.gt.1)) then    !yz-plane
        itec = nvy
        jtec = nvz
        ktec = 1
        
        itec_vel = itec
        jtec_vel = jtec
        ktec_vel = ktec
        
        if(nvygls == nvyls) then
            itec_vel = itec_vel - 1
        end if
        
        if(nvzgls == nvzls) then
            jtec_vel = jtec_vel - 1
        end if
        
      end if

!c  for 1d-cases

      if ((nvx.gt.1).and.(nvy.eq.1).and.(nvz.eq.1)) then        !x-axis
        itec = nvx
        jtec = 1
        ktec = 1
        
        itec_vel = itec
        jtec_vel = jtec
        ktec_vel = ktec
        
        if(nvxgls == nvxls) then
            itec_vel = itec_vel - 1
        end if
        
      elseif ((nvx.eq.1).and.(nvy.gt.1).and.(nvz.eq.1)) then    !y-axis
        itec = nvy
        jtec = 1
        ktec = 1
        
        itec_vel = itec
        jtec_vel = jtec
        ktec_vel = ktec        
        
        if(nvygls == nvyls) then
            itec_vel = itec_vel - 1
        end if
        
      elseif ((nvx.eq.1).and.(nvy.eq.1).and.(nvz.gt.1)) then    !z-axis
        itec = nvz
        jtec = 1
        ktec = 1
        
        itec_vel = itec
        jtec_vel = jtec
        ktec_vel = ktec
        
        if(nvzgls == nvzls) then
            itec_vel = itec_vel - 1
        end if
        
      end if
      
      !for global domain
      if ((nvxgbl.gt.1).and.(nvygbl.gt.1).and.(nvzgbl.gt.1)) then
        itec_gbl = nvxgbl
        jtec_gbl = nvygbl
        ktec_gbl = nvzgbl
        
        itec_vel_gbl = itec_gbl-1
        jtec_vel_gbl = jtec_gbl-1
        ktec_vel_gbl = ktec_gbl-1        
      end if

!c  for 2d-cases

      if ((nvxgbl.gt.1).and.(nvygbl.gt.1).and.(nvzgbl.eq.1)) then        !xy-plane
        itec_gbl = nvxgbl
        jtec_gbl = nvygbl
        ktec_gbl = 1
        
        itec_vel_gbl = itec_gbl-1
        jtec_vel_gbl = jtec_gbl-1
        ktec_vel_gbl = 1        
       
      elseif ((nvxgbl.gt.1).and.(nvygbl.eq.1).and.(nvzgbl.gt.1)) then    !xz-plane
        itec_gbl = nvxgbl
        jtec_gbl = nvzgbl
        ktec_gbl = 1
        
        itec_vel_gbl = itec_gbl-1
        jtec_vel_gbl = jtec_gbl-1
        ktec_vel_gbl = 1
        
      elseif ((nvxgbl.eq.1).and.(nvygbl.gt.1).and.(nvzgbl.gt.1)) then    !yz-plane
        itec_gbl = nvygbl
        jtec_gbl = nvzgbl
        ktec_gbl = 1
        
        itec_vel_gbl = itec_gbl-1
        jtec_vel_gbl = jtec_gbl-1
        ktec_vel_gbl = 1
      end if

!c  for 1d-cases

      if ((nvxgbl.gt.1).and.(nvygbl.eq.1).and.(nvzgbl.eq.1)) then        !x-axis
        itec_gbl = nvxgbl
        jtec_gbl = 1
        ktec_gbl = 1
        
        itec_vel_gbl = itec_gbl-1
        jtec_vel_gbl = 1
        ktec_vel_gbl = 1        
       
      elseif ((nvxgbl.eq.1).and.(nvygbl.gt.1).and.(nvzgbl.eq.1)) then    !y-axis
        itec_gbl = nvygbl
        jtec_gbl = 1
        ktec_gbl = 1
        
        itec_vel_gbl = itec_gbl-1
        jtec_vel_gbl = 1
        ktec_vel_gbl = 1        
        
      elseif ((nvxgbl.eq.1).and.(nvygbl.eq.1).and.(nvzgbl.gt.1)) then    !z-axis
        itec_gbl = nvzgbl
        jtec_gbl = 1
        ktec_gbl = 1
        
        itec_vel_gbl = itec_gbl-1
        jtec_vel_gbl = 1
        ktec_vel_gbl = 1
      end if
      
      ntecvel_dif = itec*jtec*ktec-itec_vel*jtec_vel*ktec_vel
      ntecvel_dif_gbl = itec_gbl*jtec_gbl*ktec_gbl -                   &
                        itec_vel_gbl*jtec_vel_gbl*ktec_vel_gbl 
      
      return
      end
