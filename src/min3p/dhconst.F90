!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 221 $
!> $Author: dsu $
!> $Date: 2014-08-05 14:29:49 -0700 (Tue, 05 Aug 2014) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/dhconst.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine dhconst
!c ------------------
!c compute debye huckel constants a_d and b_d
!c taken from MINTEQA2
!c
!c written by:      Uli Mayer - April 18, 96 
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           dhad               = Debye Huckel constant a_d depending - +
!c                                on dielectric constant and
!c                                temperature
!c           dhbd               = Debye Huckel constant b_d depending - +
!c                                on dielectric constant and
!c                                temperature
!c           tconv              = temperature conversion factor       + -
!c           tempk              = temperature [deg K]                 + -
!c 
!c local:    real*8:
!c           -------
!c           s1                 = intermediate value
!c           s2                 = intermediate value
!c           s3                 = intermediate value
!c           bob1               = intermediate value
!c           bob2               = intermediate value
!c           bob3               = intermediate value
!c           bob4               = intermediate value
!c           cc1                = intermediate value
!c  
!c external: -
!c ----------------------------------------------------------------------
 
      subroutine dhconst(dhad,dhbd,tempk,tconv)
 
      implicit none
      
      real*8 :: dhad,dhbd,tempk,tconv
      
      !local variables
      real*8 :: tempc, s1, s2, s3, bob1, bob2, bob3, bob4, cc1

!c  compute temperature in [deg C]
  
      tempc = tempk - tconv
     
!c  this subroutine which computes the Debye-Huckel
!c  constants as a function of temperature was taken directly
!c  from WATEQ2 (Ball et al. 1979). The mathematics is documented
!c  in Truesdell and Jones (1974).

      s1 = 374.11d0-tempc
      s2 = s1**(1.0d0/3.0d0)
      bob1 = (1.0d0+0.1342489d0*s2-3.946263d-03*s1)
      bob2 = (3.1975d0-0.3151548d0*s2-1.203374d-3*s1)
      bob3 = (7.48908d-13*s1**4.0d0)
      bob4 = bob2+bob3
      s3 = dsqrt(bob1/bob4)
      if (tempk.lt.373.16d0) then
         cc1 = 87.74d0-tempc*(tempc*(1.41d-6*tempc-9.398d-4)+0.4008d0)
      else
         cc1 = 5321d0/tempk+233.76d0-tempk*(tempk*(8.29d-7*tempk- &
           1.417d-3)+.9297d0)
      endif
 
      cc1 = dsqrt(cc1*tempk)
      dhad = 18246d2*s3/cc1**3.0d0
      dhbd = 50.29d0*s3/cc1
 
      return
      end
