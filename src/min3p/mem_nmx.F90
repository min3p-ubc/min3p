!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 786 $
!> $Author: dsu $
!> $Date: 2021-01-06 21:41:32 -0800 (Wed, 06 Jan 2021) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/mem_nmx.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c -----------------------------------------------------------------------
!c subroutine mem_nmx
!c ------------------
!c
!c allocate memory for one-dimensional arrays of size nmx and 
!c related arrays
!c
!c written by:      Uli Mayer - January 10, 2000
!c
!c last modified:   -
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   -
!c
!c common:
!c gen.f:    integer:
!c           --------
!c           ilog               = unit number, logbook file           + -
!c
!c chem.f:   real*8:
!c           -------
!c           dhcmx(nmx)         = enthalpy change of dissolution-     * +
!c                                precipitation reaction
!c                                (excluded minerals)
!c           eqmx(nmx,nthreads) = equilibrium constants for excluded  * +
!c                                minerals
!c           eqmxs(nmx)         = equilibrium constants for excluded  * +
!c                                minerals at standard temperature
!c           satmx(nmx)         = saturation indices for excluded     * +
!c                                minerals
!c           xnumx(nmx*nc)      = stoichiometric coefficients of      * +
!c                                components in excluded mineral
!c
!c           integer:
!c           --------
!c           iamx(nmx+1)        = row pointer array to                * +
!c                                stoichiometric coefficients of
!c                                components in excluded mineral
!c           jamx(nmx*nc)       = column pointer array to             * +
!c                                stoichiometric coefficients of
!c                                components in excluded mineral
!c           l_namemx(nmx)      = length of names of excluded         * +
!c                                minerals
!c           namemx(nmx)        = names of excluded minerals          * +
!c           nmx                = number of excluded minerals         + -
!c
!c           logical:
!c           --------
!c
!c           character:
!c           ----------
!c
!c local:    integer:
!c           --------
!c           ierr               = 0 -> memory allocation successful
!c
!c external: checkerr  = check for error during memory allocation
!c
!c---------------------------------------------------------------------- 
!c WARNING
!c---------------------------------------------------------------------- 
!c All allocated variables are initialized to some value. This depends  
!c of its type:
!c 
!c real*8      => 0.0d0
!c integer     => 0 
!c character   => ' '    
!c logical     => .false. 
!c 
!c Sergio Andres Bea Jofre (2009)
!c
!c ----------------------------------------------------------------------
  
      subroutine mem_nmx
 
      use parm
      use gen
      use chem
 
      implicit none
      
      integer :: ierr
      
      external checkerr

!c  main variables - excluded minerals

      allocate (dhcmx(nmx), stat = ierr)
      dhcmx=0.0d0
      call checkerr(ierr,'dhcmx',ilog)
      call memory_monitor(sizeof(dhcmx),'dhcmx',.true.)

      allocate (eqmx(nmx,nthreads), stat = ierr)
      eqmx=0.0d0
      call checkerr(ierr,'eqmx',ilog)
      call memory_monitor(sizeof(eqmx),'eqmx',.true.)

      allocate (eqmxs(nmx), stat = ierr)
      eqmxs=0.0d0
      call checkerr(ierr,'eqmxs',ilog)
      call memory_monitor(sizeof(eqmxs),'eqmxs',.true.)

      allocate (xnumx(nmx*nc), stat = ierr)
      xnumx=0.0d0
      call checkerr(ierr,'xnumx*nc',ilog)
      call memory_monitor(sizeof(xnumx),'xnumx',.true.)

      allocate (satmx(nmx), stat = ierr)
      satmx=0.0d0
      call checkerr(ierr,'satmx',ilog)
      call memory_monitor(sizeof(satmx),'satmx',.true.)

      allocate (iamx(nmx+1), stat = ierr)
      iamx=0
      call checkerr(ierr,'amx',ilog)
      call memory_monitor(sizeof(iamx),'iamx',.true.)

      allocate (jamx(nmx*nc), stat = ierr)
      jamx=0
      call checkerr(ierr,'jamx',ilog)
      call memory_monitor(sizeof(jamx),'jamx',.true.)

      allocate (l_namemx(nmx), stat = ierr)
      l_namemx=0 
      call checkerr(ierr,'l_namemx',ilog)
      call memory_monitor(sizeof(l_namemx),'l_namemx',.true.)

      allocate (namemx(nmx), stat = ierr)
      namemx=' ' 
      call checkerr(ierr,'namemx',ilog)
      call memory_monitor(sizeof(namemx),'namemx',.true.)

      return
      end
