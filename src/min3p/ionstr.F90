!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 221 $
!> $Author: dsu $
!> $Date: 2014-08-05 14:29:49 -0700 (Tue, 05 Aug 2014) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/ionstr.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine ionstr 
!c -----------------
!c compute ionic strength 
!c
!c written by:      Uli Mayer - October 10, 95
!c
!c last modified:   Uli Mayer - November 15, 96
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           ------- 
!c           c(nc)            = concentrations of free species        + -
!c           cx(nx)           = concentrations of secondary aqueous   + -
!c                              species
!c           chargec(nc)      = charge of free species                + -
!c           chargex(nx)      = charge of secondary aqueous species   + -
!c           strion           = ionic strength of solution            * +
!c
!c           integer*4:
!c           ----------
!c           nc               = number of components                  + -
!c           nx               = number of secondary aqueous species   + -
!c
!c           character:
!c           ----------
!c           namec(nc)          = component names                     + -
!c
!c local:    real*8:
!c           -------
!c           r0               = constant
!c           rhalf            = constant
!c
!c           integer*4:
!c           ----------
!c           ic               = counter (free species)
!c           ix               = counter (secondary aqueous species)
!c
!c external: -
!c ---------------------------------------------------------------------- 

      subroutine ionstr(c,cx,strion,chargec,chargex,nc,nx,namec)

      implicit none

      character*72 namec
      real*8 :: c, cx, chargec, chargex
      integer :: nc, nx
      dimension c(*),cx(*),chargec(*),chargex(*),namec(*)
      
      real*8 :: r0, rhalf, strion
      integer :: ic, ix
      parameter (r0 = 0.0d0, rhalf = 0.5d0)

!c  initialize ionic strength

      strion = r0
 
!c  free species (excluding h2o)
 
      do ic=1,nc
        if (namec(ic).ne.'e-1') then
          strion = strion + chargec(ic)**2 * c(ic)
        end if
      end do
 
!c  secondary aqueous species
 
      do ix=1,nx
        strion = strion + chargex(ix)**2 * cx(ix)
      end do
 
!c  calculate final value
 
      strion = rhalf * strion
      
      return
      end
