!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 268 $
!> $Author: dsu $
!> $Date: 2015-01-09 17:00:41 -0800 (Fri, 09 Jan 2015) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/fluxv.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c real*8 function fluxv
!c ---------------------
!c
!c compute advective mass flux
!c
!c written by:      Uli Mayer - August 15, 96
!c
!c last modified:
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           totc_i             = total aqueous component             + -
!c                                concentration in control volume i
!c           totc_j             = total aqueous component             + -
!c                                concentration in control volume j
!c           cinfrt_v           = influence coeffcient for            + -
!c                                advective flux
!c           fluxv              = advective flux                      * +
!c
!c           character:
!c           ----------
!c           spatial_weighting  = 'upstream' -> upstream weigthing    + -
!c                                'centered' -> centered weighting
!c                                'vanleer' -> Van Leer flux limiter
!c
!c common:   -
!c
!c local:    real*8:
!c           -------
!c           totc_ij          = total aqueous component concentration
!c                              at interface
!c           rhalf            = constant
!c           r0               = constant
!c
!c external: -  
!c ----------------------------------------------------------------------
 
      real*8 function fluxv(totc_i,totc_j,cinfrt_v,spatial_weighting)
 
      implicit none
      
      real*8 :: totc_i,totc_j,cinfrt_v
      
      real*8 :: r0, rhalf, totc_ij

      parameter (r0 = 0.0d0, rhalf = 0.5d0)

      character*12 spatial_weighting

      totc_ij = r0

!c  upstream weigthing 

      if (spatial_weighting.eq.'upstream') then

        if (cinfrt_v.gt.r0) then
          totc_ij = totc_i
        else
          totc_ij = totc_j
        end if

!c  centered weigthing 

      elseif (spatial_weighting.eq.'centered') then

        totc_ij = rhalf*(totc_i+totc_j)

      end if

      fluxv = cinfrt_v * totc_ij
 
      return
      end
