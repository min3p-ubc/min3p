!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 826 $
!> $Author: dsu $
!> $Date: 2022-03-24 10:10:16 -0700 (Thu, 24 Mar 2022) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/dgm/lennard_jones.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine lennard_jones
!c ------------------------
!c compute diffusion coeff using Lennard-Jones potentials
!c
!c written by:      Sergi Molins - Jan 11, 2007
!c
!c last modified:   -
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           c(nc)              = concentrations of components        + -
!c                                as species in solution
!
!c
!c           integer*4:
!c           ----------
!c           nc                 = number of components                + -
!
!c
!c           character:
!c           ----------
!c           name               = name of current dissolved species   + -
!c 
!c local:    real*8:
!c           ------- 
!c           c1                 = constant
!c
!c           integer*4:
!c           ----------
!c           ic                 = counter (components)
!c
!c external: -
!c ---------------------------------------------------------------------- 
      subroutine lennard_jones(sigma,epsil,visc_comp_g,diff_bin_g)

        use gen, only : sec_per_days
        use chem, only : ng, tempk, gfwg
        

        implicit none
       
        real*8, parameter ::                                           &
     &           r1 = 1.0d0,    rhalf = 5.0d-1,   rsesq = 1.5d0,       &
     &           r0 = 0.0d0,       r2 = 2.0d0,    rcnst = 1.858d-7,    &
     &           rA = 1.06036d0,   rB = 0.15610d0,   rC = 0.19300d0,   &
     &           rD = 0.47635d0,   rE = 1.03587d0,   rF = 1.52996d0,   &
     &           rG = 1.76474d0,   rH = 3.89411d0, rcst = 26.69d-7,    &
     &           rAA = 1.16145d0, rBB = 0.14874d0,  rCC = 0.52487d0,   &
     &           rDD = 0.77320d0, rEE = 2.16178d0,  rFF = 2.43787d0
     
!c     passed
        real*8 :: sigma(ng), epsil(ng), visc_comp_g(ng),               &
                  diff_bin_g(ng,ng)
    
!c     local
        integer*4 :: ig, jg    
        real*8    :: sigmaij, epsilonij, tstar, omega

!c     diffusion coefficients
    
        do ig = 1,ng-1
      
          do jg = ig + 1,ng

            sigmaij = rhalf*(sigma(ig)+sigma(jg))
            epsilonij = (epsil(ig)*epsil(jg))**rhalf
            
            tstar = tempk / epsilonij

            omega = rA / tstar**rB + rC / exp(rD*tstar) +              &
     &              rE / exp(rF*tstar) + rG / exp(rH*tstar)


            diff_bin_g(ig,jg) = rcnst* tempk**rsesq *                  &
     &                            ( (gfwg(ig)+gfwg(jg))/               &
     &                              (gfwg(ig)*gfwg(jg)) )**rhalf /     &
     &                            ( sigmaij**r2 * omega )
!       2012-11-06 corrected
!c         convert to units of m/d
            diff_bin_g(ig,jg) = diff_bin_g(ig,jg) * sec_per_days
     
           enddo

        enddo

        do ig = 2,ng
          do jg = 1,ig-1
            diff_bin_g(ig,jg) = diff_bin_g(jg,ig)
          enddo
        enddo

!c     viscosity    
!c    do ig = 1,ng    
!c      tstar = tempk / epsil(ig)
!c        omega = rAA / tstar**rBB + rCC / exp(rDD*tstar) +
!c     &          rEE / exp(rFF*tstar)
!c        visc_comp_g(ig) = rcst * 
!c     &                  ( gfwg(ig) * tempk )**rhalf / 
!c     &                  ( sigma(ig)**r2 * omega )
!!       2012-11-06 corrected    
!c    enddo

    return
    end