!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 221 $
!> $Author: dsu $
!> $Date: 2014-08-05 14:29:49 -0700 (Tue, 05 Aug 2014) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/totconcg.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine totconcg
!c -------------------
!c
!c compute total gaseous component concentrations based on concentrations
!c of gases 
!c
!c written by:      Uli Mayer - September 24, 96
!c
!c last modified:   Uli Mayer - December 6, 96
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           g(ng)              = gas concentrations [moles/l air]    + -
!c           totg(nc-1)         = total gaseous component             * +
!c                                concentrations [moles/l air]
!c
!c common:
!c chem.f:   real*8:
!c           -------
!c           xnug(ng*nc)        = stoichiometric coefficient matrix   + -
!c                                for formation of gases from
!c                                free species
!c
!c           integer*4:
!c           ----------
!c           iaga(ng+1)         = row pointer array to                + -
!c                                stoichiometric coefficients of
!c                                free species in gases
!c           jaga(ng*nc)        = column pointer array to             + -
!c                                stoichiometric coefficients of
!c                                free species in gases
!c           ng                 = number of gases                     + -
!c           nc                 = number of components including h2o  + -
!c
!c local:    real*8:
!c           -------
!c           r0                 = constant
!c
!c           integer*4:
!c           -----------
!c           i                  = counter (stoichiometric 
!c                                         coefficients)
!c           ic                 = counter (components)
!c           ig                 = counter (gases) 
!c           iend               = pointer (stoichiometric
!c                                         coefficients)
!c           istart             = pointer (stoichiometric
!c                                         coefficients)
!c
!c external: -
!c ----------------------------------------------------------------------
  
      subroutine totconcg(g,totg)
 
      use parm
      use chem
 
      implicit none
      
      real*8 :: g, totg

      dimension g(*),totg(*)

      real*8 :: r0
      
      parameter (r0 = 0.0d0)
      
      integer :: i, ic, ig, istart, iend
 
!c  initialize total gaseous component concentrations

      do ic = 1,nc-1
        totg(ic) = r0
      end do

!c  sum up contributions of gases
 
      do ig=1,ng
        istart = iaga(ig)
        iend = iaga(ig+1)-1
        do i= istart,iend
          ic = jaga(i)
 
!c skip h2o, since not a primary unknown
 
          if (namec(ic).ne.'h2o') then
            totg(ic) = totg(ic)+xnug(i)*g(ig)
          end if
        end do
      end do
  
      return
      end
