!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 786 $
!> $Author: dsu $
!> $Date: 2021-01-06 21:41:32 -0800 (Wed, 06 Jan 2021) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/mem_bbls.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c -----------------------------------------------------------------------
!c subroutine mem_bbls
!c -----------------
!c
!c allocate memory for one-dimensional arrays for bubble problem
!c
!c written by:      Rich Amos - June 23, 2003
!c
!c last modified:   - 
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   -
!c
!c common:
!c bbls.f    real*8
!c           ------
!c          tot_gas(ng,nn)     = total concentration of gas in
!c                               the aqueous and gas phases
!c          k_henry(ng,nn)     = henry's law constant for gas(i)->gas pair(i)
!c          aqueous_gas(ng)     = concentration of gas pair in the aqueous phase
!c                                (either as a component or a secondary species)
!c                                (mole/L)
!c           gascon_a(ng)       = temperature dependent solubility coefficient
!c           gascon_b(ng)       = temperature dependent solubility coefficient
!c           gascon_c(ng)       = temperature dependent solubility coefficient
!c
!c          integer
!c          -------
!c          gas_pair(ng)         = component or species number for
!c                                  gas pair for each gas
!c          logical
!c          -------
!c          gas_species(ng,nx)    = .true.-> species ix has a common 
!c                                  component with gas ig 
!c          update_component(nc)  = .true.-> component is an assigned gas
!c                                  component or h+ and totcnew is updated in jacrt
!c                                 .false.-> totcnew is not updated in jacrt
!c           character
!c           ---------
!c           gas_type(ng)       = specifies temperature dependence of solubility
!c                               'type_0' enthalphy (default)              
!c                               'type_1' CRC handbook
!c                               'type_2' bunsen solubility coefficients
!c
!c chem.f    integer*4:
!c           ----------
!c
!c           nc                 = number of components including h2o
!c          ng                 = number of gases
!c          nx                 = number of secondary aqueous species
!c
!c local:    integer:
!c           --------
!c           ierr               = 0 -> memory allocation successful
!c
!c external: checkerr  = check for error during memory allocation
!c ----------------------------------------------------------------------
  
      subroutine mem_bbls
 
      use parm
      use bbls
      use chem
      use gen
 
      external checkerr

!c  main variables - gases

      allocate (gas_pair(ng), stat = ierr)
      gas_pair = 0
      call checkerr(ierr,'gas_pair',ilog)
      call memory_monitor(sizeof(gas_pair),'gas_pair',.true.)

      allocate (aqueous_gas(ng), stat = ierr)
      aqueous_gas = 0.0d0
      call checkerr(ierr,'aqueous_gas',ilog)
      call memory_monitor(sizeof(aqueous_gas),'aqueous_gas',.true.)

      allocate (gas_species(ng,nx), stat = ierr)
      gas_species = .false.
      call checkerr(ierr,'gas_species',ilog)
      call memory_monitor(sizeof(gas_species),'gas_species',.true.)

      allocate (update_component(nc-1), stat = ierr)
      update_component = .false.
      call checkerr(ierr,'update_component',ilog)
      call memory_monitor(sizeof(update_component),'update_component',.true.)

      return
      
      end
