!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 268 $
!> $Author: dsu $
!> $Date: 2015-01-09 17:00:41 -0800 (Fri, 09 Jan 2015) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/opntemp.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine opntemp
!c ------------------
!c
!c open file containing temperature data and define read initial 
!c temperature profile
!c
!c written by:      Uli Mayer - June 30, 1999
!c
!c last modified:   
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c 
!c                                                                    I O
!c passed:    -
!c
!c common: 
!c gen.f:    integer*4:
!c           ----------
!c           item               = unit number, temperature data       - +
!c
!c chem.f:   real*8:
!c           -------
!c           dt_tmp             = time increment in temperature data  - +
!c                                file
!c           tmp(ntmp)          = specified depth dependent           - +
!c                                temperatures [K]
!c           tmp_read           = time to read next temperature       - +
!c           ztmp(ntmp)         = depths of specified temperatures    - +
!c           tconv              = temperature correction factor       + -
!c 
!c           integer*4:
!c           ---------- 
!c           ntmp               = number of temperature points        - +
!c
!c local:    real*8:
!c           -------
!c
!c           integer*4:
!c           ----------
!c           i                  = counter
!
!c external:  mem_ntmp = allocate memory for one-dimensional arrays
!c                       of size ntmp
!c ----------------------------------------------------------------------
 
      subroutine opntemp
 
      use parm
      use gen
      use chem
      use file_unit, only : lun_get

      implicit none
      
      integer :: i

      external mem_ntmp

!c  define unit number

      !item = 14
      item = lun_get()

!c  open file containing temperature data

      open(item,file=prefix(:l_prfx)//'.tem',status='old')
 
!c  read time interval, number of data points and associated depths
!c  and allocate memory

      read(item,*) dt_tmp, ntmp

      call mem_ntmp

      backspace(item)
      read(item,*) dt_tmp, ntmp, (ztmp(i),i=1,ntmp) 

      tmp_read = dt_tmp

!c  read initial temperature data

      read(item,*) (tmp(i),i=1,ntmp)

      do i = 1,ntmp
        tmp(i) = tmp(i) + tconv
      end do

      return
      end
