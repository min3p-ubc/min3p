!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 268 $
!> $Author: dsu $
!> $Date: 2015-01-09 17:00:41 -0800 (Fri, 09 Jan 2015) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/findname.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine findname
!c -------------------
!c
!c find name in data file       
!c
!c written by:      Uli Mayer - November 10, 01
!c
!c last modified:
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   integer*4:
!c           ----------
!c           itmp
!c
!c           logical:
!c           ---------
!c           found_name
!c
!c           character:
!c           ----------
!c           name
!c
!c common:   -
!c
!c local:    character:
!c           ----------
!c           string
!c
!c external: -
!c ----------------------------------------------------------------------
 
      subroutine findname(name,itmp,found_name)

      use gen, only : rank, ilog      
#ifdef PETSC
      use petsc_mpi_common, only : petsc_mpi_finalize
#endif

      implicit none

      integer :: itmp
      logical found_name
      character*72 name,string
 
!c  rewind input file

      rewind(itmp)

!c  search for text string in input file

      found_name = .false.
      do while (.not.found_name)
        read(itmp,*,err=1000,end=999) string
        if (string.eq.name) then
          found_name = .true.  
        end if
      end do

999   return

1000  backspace (unit=itmp, err=999)
      backspace (unit=itmp, err=999)
      read(itmp,'(a)') string
      if (rank == 0) then
        write(*,'(2a)') "Error in findname, error line: ",trim(string)
        write(ilog,'(2a)') "Error in findname, error line: ",trim(string)
        close(ilog)
      end if

#ifdef PETSC
      call petsc_mpi_finalize
#endif
      stop       

      end
