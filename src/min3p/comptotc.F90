!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 221 $
!> $Author: dsu $
!> $Date: 2014-08-05 14:29:49 -0700 (Tue, 05 Aug 2014) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/comptotc.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c -----------------------------------------------------------------------
!c subroutine comptotc
!c -------------------
!c
!c compress concentration vector, if number of unknowns is reduced 
!c due to redox equilibrium reactions
!c
!c written by:      Uli Mayer - June 23, 97
!c
!c last modified:   -
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           totc(nc-1)         = total concentrations vector         + +
!c
!c common:
!c chem.f:   real*8:
!c           -------
!c           xnur(nr*nc)        = stoichiometric coefficient of       + -
!c                                component in redox couple
!c                                reaction equation
!c
!c           integer*4:
!c           ----------
!c           iarc(nr+1)         = row pointer array to                + -
!c                                stoichiometric coefficients in
!c                                redox reaction
!c           jarc(nr*nc)        = column pointer array to             + -
!c                                stoichiometric coefficients in
!c                                redox reaction
!c           nc                 = number of components including h2o  + -
!c           nopu               = number of primary unknowns          + -
!c           nr                 = number of redox couples             + -
!c
!c
!c
!c local:    integer*4:
!c           ----------
!c           i                  = counter (stoichiometric
!c                                coefficients)
!c           ic                 = counter (components)
!c           ir                 = counter (redox couples)
!c           istart             = pointer (stoichiometric 
!c                                coefficients)
!c           iend               = pointer (stoichiometric
!c                                coefficients)
!c
!c external: -
!c ----------------------------------------------------------------------
  
      subroutine comptotc(totc)
 
      use parm
      use chem
 
      implicit none
      
      real*8 :: totc

      dimension totc(*)
      
      integer :: i, ic, ir, istart, iend
 
!c  compress system - add up excluded total concentrations to remaining 
!c  total concentrations 

      do ir = 1,nr
        istart = iarc(ir)
        iend = iarc(ir+1)-1
        do i = istart,iend
          ic = jarc(i)

!c  skip h2o, since not a primary unknown
 
          if (namec(ic).ne.'h2o') then
            totc(ic) = totc(ic)+xnur(i)*totc(ir+nopu)
          end if
        end do
      end do
 
      return
      end
