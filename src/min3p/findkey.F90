!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 268 $
!> $Author: dsu $
!> $Date: 2015-01-09 17:00:41 -0800 (Fri, 09 Jan 2015) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/findkey.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine findkey
!c ------------------
!c
!c find keyword1 in datablock bounded by keyword2        
!c
!c written by:      Uli Mayer - November 10, 01
!c
!c last modified:
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   integer*4:
!c           ----------
!c           itmp
!c
!c           logical:
!c           ---------
!c           found_keyword
!c           searching
!c
!c           character:
!c           ----------
!c           keyword1
!c           keyword2
!c
!c common:   -
!c
!c local:    character:
!c           ----------
!c           string
!c
!c external: -
!c ----------------------------------------------------------------------
 
      subroutine findkey(keyword1,keyword2,itmp,found_keyword,    &
                searching)
      
      implicit none
      
      integer :: itmp 

      logical found_keyword, searching
      character*72 keyword1,keyword2,string
 
!c  search for keyword1 in datablock bound by keyword2

      found_keyword = .false.
    searching = .true.
      do while (searching.and..not.found_keyword)
        read(itmp,*,end=999) string
      write(*,*) string
        if (string.eq.keyword1) then
          found_keyword = .true.
      elseif (string.eq.keyword2) then
        searching = .false.
        end if
      end do

999   return
      end
