!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 786 $
!> $Author: dsu $
!> $Date: 2021-01-06 21:41:32 -0800 (Wed, 06 Jan 2021) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/dgm/diffcoff_g.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c real*8 function diffcoff_g
!c --------------------------
!c
!c compute effective diffusion coefficient in the gas phase
!c
!c 'same as aqueous'  : default to diff_coff.f
!c 'millington'       : millington-quirk =  S_p^10/3 * por^4/3
!c                      (see diff_coff.f)
!c 'no correction'    : tortuosity = 1.0
!c 'moldrup repacked' : moldup-repacked  =  S_p^5/2 * por^3/2
!c
!c written by:      Sergi Molins - May 2, 2006
!c
!c last modified:   Sergi Molins - Jan 11, 2007
!c                  millington-2 correction added 
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           diffcoff           = effective diffusion coefficient     * +
!c           diff_p             = free diffusion coefficient in       + -
!c                                phase p
!c           sat_p              = saturation of phase p               + -
!c           por                = porosity                            + -
!c           tortuosity_corr    = .true.  -> Millington-Quirk         + -
!c                                           tortuosity correction
!c                                           for diffusion
!c                                           coefficients
!c           character:
!c           ----------
!c           gas_tortuosity     = 'same as aqueous'
!c                                'millington'
!c                                'no correction'
!c                                'moldrup repacked'
!c
!c common:   -
!c
!c local:    real*8:
!c           -------
!c           r2                 = constant
!c           r3                 = constant
!c           r4                 = constant
!c           r5                 = constant
!c           r10                = constant
!c
!c external: diffcoff.f -> diffusion coeff using aqueous phase subroutine
!c ----------------------------------------------------------------------
 
      real*8 function diffcoff_g(diff_p,sat_p,por,tortuosity_corr,     &
                                 assigned_tau,tau,type_tortuosity,     &
                                 m_archie,gas_tortuosity,sat_oil,      &
                                 a_mq,b_mq)

        use mod_diffcoff, only : diffcoff

        implicit none

        real*8, parameter :: r1 = 1.0d0, r2 = 2.0d0, r3 = 3.0d0,       &
                             r4 = 4.0d0, r5 = 5.0d0, r10 = 10.0d0
        
        real*8 :: diff_p, sat_p, por,tau, sat_oil, m_archie, a_mq,b_mq
 

        logical :: tortuosity_corr,assigned_tau
        character(len=*) :: type_tortuosity,gas_tortuosity

        diffcoff_g = 0.0d0
        

        if (gas_tortuosity.eq.'same as aqueous') then
        
          diffcoff_g = diffcoff(diff_p,sat_p,por,tortuosity_corr,      &
                                assigned_tau,tau,type_tortuosity,      &
                                m_archie,sat_oil,a_mq,b_mq)
        
        else if (gas_tortuosity.eq.'millington') then
        
          diffcoff_g = diff_p * sat_p**(r10/r3) * por**(r4/r3)*        &
                       (r1-sat_oil)**r2 
          
        else if (gas_tortuosity.eq.'no correction') then
        
          diffcoff_g = diff_p * sat_p * por
        
        else if (gas_tortuosity.eq.'moldrup repacked') then
        
          diffcoff_g = diff_p * sat_p**(r5/r2) * por**(r3/r2)*         &
                       (r1-sat_oil)
        
        else if (gas_tortuosity.eq.'millington-2') then
        
          diffcoff_g = diff_p * sat_p**(r2) * por**(r4/r3)*            &
                       (r1-sat_oil)**(r2/r3)
        
        else if (gas_tortuosity.eq.'manual' .or. assigned_tau) then
        
          diffcoff_g = diff_p * sat_p * por * tau
          
        end if

        return
      end
