!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 221 $
!> $Author: dsu $
!> $Date: 2014-08-05 14:29:49 -0700 (Tue, 05 Aug 2014) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/findzone.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine findzone
!c -------------------
!c
!c find zone in input section
!c
!c written by:      Uli Mayer - February 19, 98
!c
!c last modified:
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   integer*4:
!c           ----------
!c           itmp
!c           izone
!c
!c           loghical:
!c           ---------
!c           found_subsection
!c
!c           character:
!c           ----------
!c           subsection
!c
!c common:   -
!c
!c local:    integer*4:
!c           ----------
!c           izone_temp
!c
!c           character:
!c           ----------
!c           string
!c           zone_name
!c
!c external: -
!c ----------------------------------------------------------------------
 
      subroutine findzone(subsection,itmp,found_subsection,izone, &
                         zone_name)
      
      implicit none
      
      integer :: itmp, izone, izone_temp
      logical found_subsection
      character*72 subsection,string,zone_name
 
!c  rewind input file

      rewind(itmp)

!c  search for text string in input file

      found_subsection = .false.
      do while (.not.found_subsection)
        read(itmp,*,end=999,err=999) string
        if (string.eq.subsection) then
          found_subsection = .true.
        end if
        if (found_subsection) then
          read(itmp,*,end=999,err=999) izone_temp
          if (izone_temp.ne.izone) then
            found_subsection = .false.
          else
            read(itmp,*,end=999,err=999) zone_name
          end if
        end if
      end do

      goto 1000

999   found_subsection = .false.

1000  return
      end
