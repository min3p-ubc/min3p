!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 221 $
!> $Author: dsu $
!> $Date: 2014-08-05 14:29:49 -0700 (Tue, 05 Aug 2014) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/concsort.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine concsort
!c -------------------
!c
!c sort concentration array entries and in decreasing numerical order
!c and reassign accompanying species name
!c
!c written by:      Uli Mayer - February 18, 98
!c
!c last modified:   -
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c 
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           conc(n)            = concentration array to be sorted    + +
!c           gamma(n)           = activity coefficient array to be    + +
!c                                sorted
!c
!c           integer*4:
!c           ----------
!c           n                  = number of entries to be sorted      + -
!c
!c           character:
!c           ----------
!c           name(n)            = species name array to be sorted     + +
!c
!c common:   -
!c
!c local:    real*8:
!c           -------
!c           conctemp           = temporary storage for entry of 
!c                                conc
!c           gammatemp          = temporary storage for entry of 
!c                                gamma
!c
!c           integer:
!c           --------
!c           i                  = counter (sorting)
!c           ip1                = pointer (sorting)
!c           npairs             = number of pairs to compare
!c
!c           logical:
!c           --------
!c           done               = .true. -> no interchange on 
!c                                          last pass
!c
!c           character: 
!c           ----------
!c           nametemp           = temporary storage for name of 
!c                                species
!c           
!c
!c external: -
!c ----------------------------------------------------------------------

      subroutine concsort (conc,gamma,name,n)
      
      implicit none

      logical done      
      character*72 name, nametemp
      real*8 :: conc, gamma
      integer :: n
      dimension conc(*),gamma(*),name(*)
      
      !local variables
      integer :: i, ip1, npairs
      real*8 :: conctemp, gammatemp

      npairs = n - 1
      done  = .false.

      do while (.not. done)             ! continue until no interchanges
        done = .true.
        do i = 1,npairs
          ip1 = i + 1
          if (conc(i).lt.conc(ip1)) then    ! interchange
            conctemp  = conc(i)
            gammatemp = gamma(i)
            nametemp = name(i)
            conc(i)  = conc(ip1)
            gamma(i)  = gamma(ip1)
            name(i) = name(ip1)
            conc(ip1) = conctemp
            gamma(ip1) = gammatemp
            name(ip1) = nametemp
            done      = .false.
          endif
        enddo
        npairs = npairs - 1
      enddo

      return
      end
