!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 221 $
!> $Author: dsu $
!> $Date: 2014-08-05 14:29:49 -0700 (Tue, 05 Aug 2014) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/satfpres.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c real*8 function satfpres
!c ------------------------
!c  
!c compute saturation from pressure using van Genuchten relationship
!c
!c taken from Joel VanderKwaak's Water Transport Simulator (WTS)
!c Version 1.0, March, 1996 
!c 
!c written by:      Joel VanderKwaak - March 1996
!c
!c last modified:   Uli Mayer - July 27, 96
!c                  -> consistent format  
!c                  -> removed switch if (p < p_a)
!c                     already considered in calling routine
!c                  Uli Mayer - November 25, 96
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           swr                = residual water saturation           + -
!c           aentry             = air entry pressure                  + -
!c           pressure           = nodal pressure                      + -
!c           spalpha            = soil hydraulic parameter            + -
!c           spbeta             = soil hydraulic parameter            + -
!c           spgamma            = soil hydraulic parameter            + -
!c           satfpres           = water saturation                    - +
!c
!c common:   -  
!c
!c local:    real*8:
!c           -------
!c           se                 = effective saturation
!c           dp                 = pressure head difference
!c           press              = intermediate value
!c           r1                 = constant
!c
!c external: -
!c ----------------------------------------------------------------------

      real*8 function satfpres(swr,aentry,pressure,   &
     &                         spalpha,spbeta,spgamma)

      implicit none
      
      real*8 :: swr,aentry,pressure,spalpha,spbeta,spgamma
      
      real*8 :: r1, dp, press, se

      parameter (r1 = 1.0D0)

      dp = pressure-aentry
      press = spalpha*dabs(dp)
      se    = (r1+(press)**spbeta)**(-spgamma)
      satfpres = se*(r1-swr)+swr

      return
      end
