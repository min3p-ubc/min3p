!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 826 $
!> $Author: dsu $
!> $Date: 2022-03-24 10:10:16 -0700 (Thu, 24 Mar 2022) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/dgm/gasdiff_s.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c -----------------------------------------------------------------------
!c subroutine gasdiff_s
!c --------------------
!c
!c compute diffusion coefficients for gas species using LeBlanc's approx
!c
!c written by:      Sergi Molins - May 2, 2006
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           molfrac(ng)        = molar fractions of gas species      + -
!c           gasdiff_s          = gas diffusion coefficient           * +
!c
!c           integer*4:
!c           ----------
!c           lg                 = pointer to gas species              + -
!c
!c common:
!c chem.f:   integer*4:
!c           ---------
!c           ng                 = number of gas species               + - 
!c
!c phys.f    real*8:
!c           -------
!c           diff_bin_g(ng,ng)  = binary diffusion coefficients       + -
!c
!c local:    real*8:
!c           -------
!c           r0                 = constant
!c           r1                 = constant
!c
!c external: -  
!c ----------------------------------------------------------------------
  
      real*8 function gasdiff_s(molfrac,lg)
 
      use chem, only : ng
      use phys, only : diff_bin_g
      
      implicit none

!c     passed
      real*8    molfrac(ng)
      integer*4 lg, jg
      
      real*8, parameter :: r0 = 0.0d0, r1 = 1.0d0
  
      gasdiff_s = r0

      do jg = 1,ng
        if (jg.ne.lg) then
          gasdiff_s = gasdiff_s + molfrac(jg)/diff_bin_g(lg,jg)
        end if
      enddo
      
      gasdiff_s = (r1 - molfrac(lg))/gasdiff_s

      return
      end