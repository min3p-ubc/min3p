!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 221 $
!> $Author: dsu $
!> $Date: 2014-08-05 14:29:49 -0700 (Tue, 05 Aug 2014) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/setsize.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine setsize
!c ------------------
!c
!c define actual number of unknowns 
!c
!c written by:      Uli Mayer - July 8, 97
!c
!c last modified:   
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c 
!c                                                                    I O
!c passed:   redox_equil_s      = redox equilibrium reactions         + -
!c
!c common:
!c gen.f:    integer*4:
!c           ----------
!c           n                  = number of primary unknowns          + -
!c
!c chem.f:   integer*4:
!c           ----------
!c           nc                 = number of primary unknowns          + -
!c           nopu               = number of primary unknowns          + -
!c           nr                 = number of redox couples             + -
!c
!c           logical:
!c           --------
!c           redox_equil        = redox equilibrium reactions         + -
!c
!c external: -
!c ----------------------------------------------------------------------
 
      subroutine setsize(redox_equil_s)
 
      use parm
      use gen
      use chem

      implicit none

      logical redox_equil_s
   
!c  set number of primary unknowns

      if (redox_equil_s.and.nr.gt.0) then
        redox_equil = .true.
        n = nc-nr-1
        nopu = n
      else
        redox_equil = .false.
        n = nc-1
        nopu = n
      end if

      return
      end
