!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 303 $
!> $Author: dsu $
!> $Date: 2015-05-04 10:58:10 -0700 (Mon, 04 May 2015) $
!> $URL: https://min3psvn.ubc.ca/svn/min3p_thcm/branches/dsu_new_add_2024Jan/src/min3p/assnpair.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine assnpair
!c -------------------
!c
!c search for gas pair and assign value for gas_pair(ig)  
!c
!c written by:      Rich Amos - June 23, 2003
!c
!c last modified:   Rich Amos - March 28, 2004
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:  integer
!c          -------
!c          ig             = counter (gases)
!c
!c          character
!c          ---------
!c          pair         = name of component paired with each gas
!c
!c
!c common:
!c bbls.f   integer
!c          -------
!c          gas_pair(ig)    =  component number for
!c                           gas pair for each gas
!c
!c          logical
!c          -------
!c         found_pair        = .true. -> component or species pair of gas
!c                          found in component or species 
!c                          array
!c         update_component(nc)  = .true.-> component is an assigned gas
!c                                component or h+ and totcnew is updated in jacrt
!c                                .false.-> totcnew is not updated in jacrt
!c
!c gen.f   integer
!c         -------
!c           ilog               = unit number, logbook file
!c
!c chem.f  integer
!c        -------
!c        nc                 = number of components including h2o
!c
!c         character:
!c         ----------
!c         namec(nc)          = component names
!c
!c local    integer
!c         -------
!c         ic                = counter (components)
!c
!c
!c----------------------------------------------------------------------
    subroutine assnpair(pair, ig)

    use bbls
    use gen
    use chem
#ifdef PETSC
    use petsc_mpi_common, only : petsc_mpi_finalize
#endif

    implicit none
    
    integer :: ic, ig

    character*12 :: pair

!c_bubbles Look for 'pair' in components then species
                
        found_pair = .false.
        do ic=1,nc-1
          if (namec(ic).eq.pair) then    
            gas_pair(ig) = ic
            found_pair = .true.
            update_component(ic)=.true.
          else if (namec(ic).eq.'h+1') then
            update_component(ic)=.true.
          end if
        end do
                
        if (.not.found_pair) then
          if (rank == 0) then  
            write(ilog,*) 'SIMULATION TERMINATED'
            write(ilog,*) 'gas pair ',pair,'not found'
            write(ilog,*) 'gas pair must be a component'
            close(ilog)
          end if
#ifdef PETSC
          call petsc_mpi_finalize
#endif
          stop
        end if
    return
    end 
